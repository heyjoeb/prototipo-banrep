!function(e,o,t,i){"use strict";t.Icon.Default.imagePath="images/";var a=new t.LatLngBounds(new t.LatLng(14.658129,-82.200288),new t.LatLng(12.400129,-79.866288)),n=t.map("map",{center:new t.LatLng(12.55673,-81.71852),zoom:14}),r=t.rectangle(a).getLatLngs();t.polyline(r.concat([r[0]])).addTo(n),n.setMaxBounds(a);var s=t.geoCsv(null,{fieldSeparator:";",firstLineTitles:!0,onEachFeature:function(e,o){var t="<h1>"+e.properties.popup+"</h1><img src="+e.properties.image+"><p>"+e.properties.text+"</p><p>"+e.properties.text2+"</p><p>"+e.properties.text3+"</p><p>"+e.properties.text4+"</p>",i={maxWidth:"280",className:"custom"};o.bindPopup(t,i)},pointToLayer:function(e,o){return t.marker(o,{icon:t.icon({iconUrl:e.properties.icon,iconSize:[32,32]})})}});$.ajax({type:"GET",dataType:"text",url:"../datos.csv",error:function(){alert("No se pudieron cargar los datos")},success:function(e){function o(e){var o="",t="",i="",a="";if("undefined"==typeof e[0])return null;if(e[0].constructor===Object)for(var n in e)for(var r in e[n])if("lat"===r&&(t=e[n][r]),"lng"===r&&(i=e[n][r]),"name"===r){a=e[n][r];var s=function(e){return e.replace(/[^a-z0-9-]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").toLowerCase()},c=s(a);o+="<li id="+c+'><a href="#"data-zoom="15"data-position='+t+","+i+">"+a+"</a></li>\r\n"}return o}s.addData(e),n.addLayer(s);var t=e,i={separator:";"},a=$.csv.toObjects(t,i),r=o(a);$("#csv-list").empty(),$("#csv-list").html(r),$("#csv-list li").each(function(){$(this).addClass("item-list")})}});var c=new t.tileLayer("https://api.mapbox.com/styles/v1/heyjoeb/cio4kq5k6004xafm06nm1pg4g/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiaGV5am9lYiIsImEiOiJjaW5vemYzeGgxMDUwdHZseXVicXZwbTAzIn0.7GJ_d9Xk-m50NUgRsOcnXg",{maxZoom:15,minZoom:14,useCache:!0,tileSize:512,zoomOffset:-1});c.on("tilecachehit",function(e){console.log("Cache hit: ",e.url)}),c.on("tilecachemiss",function(e){console.log("Cache miss: ",e.url)}),c.addTo(n),$("#seed").click(function(){c.seed(a,14,15)}),c.on("seedprogress",function(e){var o=100-Math.floor(e.remainingLength/e.queueLength*100);console.log("Seeding "+o+"% done")}),c.on("seedend",function(e){console.log("Cache seeding complete")});var l=($("#sidebar").sidebar(),"https://api.mapbox.com/styles/v1/heyjoeb/cio4kq5k6004xafm06nm1pg4g/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiaGV5am9lYiIsImEiOiJjaW5vemYzeGgxMDUwdHZseXVicXZwbTAzIn0.7GJ_d9Xk-m50NUgRsOcnXg"),p='Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',d=new t.TileLayer(l,{minZoom:0,maxZoom:13,useCache:!0,attribution:p});new t.Control.MiniMap(d,{toggleDisplay:!0}).addTo(n);o.getElementById("map-navigation").onclick=function(e){var o=e.target.getAttribute("data-position"),t=e.target.getAttribute("data-zoom");if(o&&t){var i=o.split(","),a=parseInt(t);return n.setView(i,a,{animation:!0}),!1}}}(window,document,L),$(document).ready(function(){var e=$("[data-remodal-id=modal]").remodal();e.open()}),function(){"serviceWorker"in navigator?(console.log("CLIENT: service worker registration in progress."),navigator.serviceWorker.register("service-worker.js").then(function(){console.log("CLIENT: service worker registration complete.")},function(){console.log("CLIENT: service worker registration failure.")})):console.log("CLIENT: service worker is not supported.")}(),$(window).load(function(){$(".sidebar-pane").mCustomScrollbar({theme:"rounded-dark"}),$("#csv-list li a").on("click",function(){$("li a.current").removeClass("current"),$(this).addClass("current")})});